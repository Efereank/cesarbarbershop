let paso=1;const pasoInicial=1,pasoFinal=3,cita={id:"",nombre:"",fecha:"",hora:"",servicios:[],barberoId:""};function iniciarApp(){mostrarSeccion(),tabs(),botonesPaginador(),paginaSiguiente(),paginaAnterior(),consultarAPI(),idCliente(),nombreCliente(),seleccionarFecha(),inicializarSelectHora(),actualizarDuracionServicio(),mostrarResumen(),cargarBarberos()}function mostrarSeccion(){const e=document.querySelector(".mostrar");e&&e.classList.remove("mostrar");const a=`#paso-${paso}`;document.querySelector(a).classList.add("mostrar");const t=document.querySelector(".actual");t&&t.classList.remove("actual");document.querySelector(`[data-paso="${paso}"]`).classList.add("actual");const o=document.querySelector(".footer-total");o&&(o.style.display=3===paso?"none":"flex")}function tabs(){document.querySelectorAll(".tabs button").forEach(e=>{e.addEventListener("click",function(e){paso=parseInt(e.target.dataset.paso),mostrarSeccion(),botonesPaginador(),3===paso&&mostrarResumen(),actualizarFooterTotal()})})}function botonesPaginador(){const e=document.querySelector("#anterior"),a=document.querySelector("#siguiente");1===paso?(e.classList.add("ocultar"),a.classList.remove("ocultar")):3===paso?(e.classList.remove("ocultar"),a.classList.add("ocultar"),a&&a.classList.add("ocultar")):(e.classList.remove("ocultar"),a.classList.remove("ocultar"),a&&(a.textContent="Siguiente »")),mostrarSeccion()}function paginaAnterior(){document.querySelector("#anterior").addEventListener("click",function(){paso<=1||(paso--,botonesPaginador(),actualizarFooterTotal())})}function paginaSiguiente(){const e=document.querySelector("#siguiente");e&&e.addEventListener("click",function(){paso>=3?confirmarCita():(paso++,botonesPaginador(),3===paso&&mostrarResumen(),actualizarFooterTotal())})}async function consultarAPI(){try{const e="/api/servicios",a=await fetch(e);if(!a.ok)throw new Error(`Error HTTP: ${a.status}`);mostrarServicios(await a.json())}catch(e){mostrarAlerta("Error al cargar los servicios","error",".formulario")}try{const e="/api/tasa",a=await fetch(e);mostrarResumen(await a.json())}catch(e){console.log(e)}}function mostrarServicios(e){window.todosLosServicios=e;const a=document.querySelector("#servicio");a&&(a.innerHTML="",e.forEach(e=>{const{id:t,nombre:o,precio:r,duracion:i}=e,n=document.createElement("P");n.classList.add("nombre-servicio"),n.textContent=o;const c=document.createElement("P");c.classList.add("precio-servicio"),c.textContent=`$${r}`;const s=document.createElement("P");s.classList.add("duracion-servicio"),s.textContent=`${i} minutos`,s.style.fontSize="0.8rem",s.style.color="#666";const l=document.createElement("DIV");l.classList.add("servicio"),l.dataset.idServicio=t,l.dataset.duracion=i,l.addEventListener("click",function(){seleccionarServicio(e)}),cita.servicios.some(e=>e.id===t)&&l.classList.add("seleccionado"),l.appendChild(n),l.appendChild(c),l.appendChild(s),a.appendChild(l)}),actualizarFooterTotal())}function seleccionarServicio(e){const{id:a}=e,{servicios:t}=cita,o=document.querySelector(`[data-id-servicio="${a}"]`);-1!==t.findIndex(e=>e.id===a)?(cita.servicios=t.filter(e=>e.id!==a),o&&o.classList.remove("seleccionado")):(cita.servicios=[...t,e],o&&o.classList.add("seleccionado")),actualizarFooterTotal(),cita.fecha&&cargarHorariosDisponibles()}function idCliente(){const e=document.querySelector("#id").value;cita.id=e}function nombreCliente(){const e=document.querySelector("#nombre").value;cita.nombre=e}function mostrarAlerta(e,a,t,o=!0){const r=document.querySelector(".alerta");r&&r.remove();const i=document.createElement("DIV");i.textContent=e,i.classList.add("alerta"),i.classList.add(a);document.querySelector(t).appendChild(i),o&&setTimeout(()=>{i.remove()},9e3)}document.addEventListener("DOMContentLoaded",function(){iniciarApp()});let duracionServicio=15;function actualizarDuracionServicio(){const e=document.querySelector("#servicioId");e&&e.addEventListener("change",function(e){const a=e.target.value;duracionServicio={1:30,2:15,3:45,4:60,5:30,6:90}[a]||15;const t=document.querySelector("#hora");t&&t.value&&validarHoraCita()})}function calcularHoraFin(e,a){const[t,o]=e.split(":").map(Number),r=new Date;return r.setHours(t,o,0,0),r.setMinutes(r.getMinutes()+a),r.toTimeString().substring(0,5)}async function verificarDisponibilidad(e,a,t,o){try{const r=await fetch("/citas/verificar-disponibilidad",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fecha:e,hora:a,hora_fin:t,duracion:o})}),i=await r.json();return i.disponible||Swal.fire({icon:"error",title:"Horario No Disponible",text:i.mensaje||"El barbero seleccionado ya tiene una cita en este horario.",confirmButtonText:"Actualizar",timer:5e3,timerProgressBar:!0}).then(e=>{window.location.reload()}),i}catch(e){return console.error("Error al verificar disponibilidad:",e),{disponible:!0}}}function seleccionarFecha(){const e=document.querySelector("#selector-fechas"),a=document.querySelector("#fecha");if(!e||!a)return;e.innerHTML='\n        <div class="selector-fechas-container">\n            <button type="button" class="flecha-deslizable flecha-izquierda" id="flecha-izquierda" aria-label="Días anteriores">\n                <span>&#9664;</span>\n            </button>\n            <div class="selector-fechas" id="contenedor-fechas"></div>\n            <button type="button" class="flecha-deslizable flecha-derecha" id="flecha-derecha" aria-label="Días siguientes">\n                <span>&#9654;</span>\n            </button>\n        </div>\n    ';const t=e.querySelector("#contenedor-fechas"),o=e.querySelector("#flecha-izquierda"),r=e.querySelector("#flecha-derecha"),i=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],n=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],c=new Date,s=new Date(c.getFullYear(),c.getMonth(),c.getDate());for(let e=0;e<5;e++){const o=new Date(s);o.setDate(s.getDate()+e);const r=o.getDay(),c=o.getDate(),l=o.getMonth(),d=document.createElement("div");d.className="dia-option",0===r&&d.classList.add("deshabilitado");const u=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`;d.dataset.fecha=u,d.title=`Seleccionar: ${u} (Mostrando: ${c})`,d.innerHTML=`\n            <div class="dia-semana">${i[r]}</div>\n            <div class="dia-numero">${c.toString().padStart(2,"0")}</div>\n            <div class="dia-mes">${n[l]}</div>\n        `,0!==r&&d.addEventListener("click",function(){this.classList.contains("seleccionado")?(this.classList.remove("seleccionado"),a.value="",void 0!==cita&&(cita.fecha="",void 0!==cargarHorariosDisponibles&&cargarHorariosDisponibles()),console.log("Fecha deseleccionada:",this.dataset.fecha)):(document.querySelectorAll(".dia-option.seleccionado").forEach(e=>{e.classList.remove("seleccionado")}),this.classList.add("seleccionado"),a.value=this.dataset.fecha,void 0!==cita&&(cita.fecha=this.dataset.fecha,void 0!==cargarHorariosDisponibles&&cargarHorariosDisponibles()),console.log("Fecha seleccionada:",this.dataset.fecha),console.log("Día mostrado en pantalla:",c),console.log("Fecha completa del objeto:",o.toString()))}),t.appendChild(d)}if(0!==s.getDay()){const e=t.querySelector(".dia-option:not(.deshabilitado)");e&&e.click()}function l(e){const a=t.scrollLeft,o="derecha"===e?a+240:a-240;t.scrollTo({left:o,behavior:"smooth"})}o.addEventListener("click",e=>{e.preventDefault(),l("izquierda")}),r.addEventListener("click",e=>{e.preventDefault(),l("derecha")}),t.addEventListener("wheel",e=>{e.preventDefault(),t.scrollLeft+=.5*e.deltaY},{passive:!1})}function seleccionarHora(){document.querySelector("#fecha").addEventListener("input",function(e){void 0!==cita&&(cita.fecha=e.target.value)}),actualizarDuracionServicio()}async function validarHoraCita(e){const a=document.querySelector("#hora"),t=document.querySelector("#fecha"),o=a.value;if(!o||!t.value)return void(void 0!==cita&&(cita.hora=""));const[r,i]=o.split(":"),n=parseInt(r,10),c=parseInt(i,10),s=new Date,l=new Date(s.toLocaleString("en-US",{timeZone:"America/Caracas"})),d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`,u=t.value,m=new Date(l.getTime()+9e5),p=m.getHours(),h=m.getMinutes();let f=!1,b="";(n<10||n>=20)&&(f=!0,b="Hora no válida. Nuestro horario de atención es de 10:00 a 20:00.");const v=calcularHoraFin(o,duracionServicio),[g,S]=v.split(":").map(Number);if((g>20||20===g&&S>0)&&(f=!0,b=`El servicio seleccionado terminaría a las ${v} fuera del horario de atención (hasta 20:00).`),u===d&&!f){let e=!1;n<p&&(e=!0),n===p&&c<h&&(e=!0),e&&(f=!0,b="Hora no válida. Las citas para hoy requieren un margen de 5 minutos.")}const y=document.querySelector(".alerta");if(f)a.value="",y&&y.textContent===b||(y&&y.remove(),mostrarAlerta(b,"error",".formulario")),void 0!==cita&&(cita.hora="");else{const e=calcularHoraFin(o,duracionServicio);try{const t=await verificarDisponibilidad(u,o,e,duracionServicio);t.disponible?(void 0!==cita&&(cita.hora=o,cita.hora_fin=e),y&&y.remove(),mostrarAlerta("Horario disponible ✓","exito",".formulario"),setTimeout(()=>{const e=document.querySelector(".alerta.exito");e&&e.remove()},3e3)):(a.value="",mostrarAlerta(t.mensaje||"Ya existe una cita en ese horario. Por favor, elige otra hora.","error",".formulario"),void 0!==cita&&(cita.hora=""))}catch(e){mostrarAlerta("Error al verificar disponibilidad. Confirma que el horario esté libre.","error",".formulario")}}}function obtenerDuracionServicio(){if(window.cita&&window.cita.servicios&&window.cita.servicios.length>0){let e=0;return window.cita.servicios.forEach(a=>{if(window.todosLosServicios){const t=window.todosLosServicios.find(e=>e.id===a.id);if(t&&t.duracion){const a=parseInt(t.duracion);e+=a}}else if(a.duracion){const t=parseInt(a.duracion);e+=t}}),e>0?e:15}const e=document.querySelectorAll(".servicio.seleccionado");if(0===e.length)return 15;let a=0;return e.forEach(e=>{const t=parseInt(e.dataset.duracion)||0;a+=t}),a>0?a:15}function inicializarSelectHora(){const e=document.querySelector("#hora");e&&e.addEventListener("change",function(){const e=this.value;if(e){if(cita.fecha){const a=validarHoraContraActual(cita.fecha,e);if(!a.valido)return mostrarAlerta(a.mensaje,"error",".formulario"),this.value="",void(cita.hora="")}cita.hora=e,cita.hora&&mostrarAlerta(`Hora seleccionada: ${cita.hora}`,"exito",".formulario",2e3)}else cita.hora=""})}async function cargarBarberos(){try{const e=await fetch("/api/barberos");mostrarBarberosVisual(await e.json())}catch(e){console.error("Error al cargar barberos:",e),mostrarAlerta("Error al cargar la lista de barberos","error",".formulario")}}function mostrarBarberosVisual(e){const a=document.querySelector("#selector-barberos"),t=document.querySelector("#barberoId");if(!a||!t)return;a.innerHTML='\n        <div class="selector-fechas-container">\n            <button type="button" class="flecha-deslizable flecha-izquierda" id="flecha-izquierda-barberos" aria-label="Barberos anteriores">\n                <span>&#9664;</span>\n            </button>\n            <div class="contenedor-barberos" id="contenedor-barberos"></div>\n            <button type="button" class="flecha-deslizable flecha-derecha" id="flecha-derecha-barberos" aria-label="Más barberos">\n                <span>&#9654;</span>\n            </button>\n        </div>\n    ';const o=a.querySelector("#contenedor-barberos"),r=a.querySelector("#flecha-izquierda-barberos"),i=a.querySelector("#flecha-derecha-barberos");function n(){const e=o.scrollLeft,a=o.scrollWidth,t=o.clientWidth;e<=10?r.classList.add("oculta"):r.classList.remove("oculta"),e+t>=a-10?i.classList.add("oculta"):i.classList.remove("oculta")}function c(e){const a=o.scrollLeft,t="derecha"===e?a+260:a-260;o.scrollTo({left:t,behavior:"smooth"}),setTimeout(n,300)}e&&e.length>0?(e.forEach(e=>{const a=document.createElement("div");a.className="barbero-option",a.dataset.barberoId=e.id,a.dataset.barberoNombre=e.nombre;const r=!1!==e.disponible,i=r?"estado-disponible":"estado-ocupado",n=r?"Disponible":"Ocupado";a.innerHTML=`\n                <div class="nombre-barbero">${e.nombre}</div>\n                ${e.especialidad?`<div class="especialidad-barbero">${e.especialidad}</div>`:""}\n                <div class="estado-barbero ${i}">${n}</div>\n            `,r?a.addEventListener("click",function(){this.classList.contains("seleccionado")?(this.classList.remove("seleccionado"),t.value="",cita.barberoId="",cita.barberoNombre=""):(document.querySelectorAll(".barbero-option.seleccionado").forEach(e=>{e.classList.remove("seleccionado")}),this.classList.add("seleccionado"),t.value=this.dataset.barberoId,cita.barberoId=this.dataset.barberoId,cita.barberoNombre=this.dataset.barberoNombre,mostrarAlerta(`Barbero seleccionado: ${cita.barberoNombre}`,"exito",".formulario",2e3),cita.fecha&&cargarHorariosDisponibles())}):(a.classList.add("deshabilitado"),a.title="Barbero no disponible en este momento"),o.appendChild(a)}),1===e.length&&!1!==e[0].disponible&&setTimeout(()=>{const e=o.querySelector(".barbero-option:not(.deshabilitado)");e&&e.click()},100)):a.innerHTML='<p class="mensaje-info">No hay barberos disponibles en este momento</p>',r.addEventListener("click",e=>{e.preventDefault(),c("izquierda")}),i.addEventListener("click",e=>{e.preventDefault(),c("derecha")}),o.addEventListener("scroll",n),setTimeout(n,100),o.addEventListener("wheel",e=>{e.preventDefault(),o.scrollLeft+=.5*e.deltaY,setTimeout(n,50)},{passive:!1})}async function cargarHorariosDisponibles(){const e=document.querySelector("#selector-horas");if(e)if(cita.fecha)if(cita.barberoId){e.innerHTML='<p class="mensaje-info">Cargando horarios disponibles...</p>';try{const t=calcularDuracionTotal(),o=["12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30"],r=20,i=e=>e.filter(e=>{const[a,o]=e.split(":").map(Number),i=new Date;return i.setHours(a,o+t,0,0),i.getHours()<r||i.getHours()===r&&0===i.getMinutes()}),n=i(["10:00","10:30","11:00","11:30"]),c=i(o),s=new Date,l={timeZone:"America/Caracas"},d=new Date(s.toLocaleString("en-US",l)),u=d.toISOString().slice(0,10);function a(e){if(cita.fecha!==u)return!0;const[a,t]=e.split(":").map(Number);return new Date(d.getFullYear(),d.getMonth(),d.getDate(),a,t).getTime()>d.getTime()}const m=n.filter(a),p=c.filter(a),h=[...m.map(e=>verificarDisponibilidadIndividual(cita.fecha,e,t,cita.barberoId,!1).then(a=>({horario:e,disponible:a,grupo:"manana"}))),...p.map(e=>verificarDisponibilidadIndividual(cita.fecha,e,t,cita.barberoId,!1).then(a=>({horario:e,disponible:a,grupo:"tarde"})))],f=await Promise.all(h),b=[],v=[];f.forEach(e=>{const{horario:a,disponible:t,grupo:o}=e;t&&("manana"===o?b.push(a):v.push(a))});let g='<div class="selector-horas-contenedor">';if(b.length>0&&(g+='<div class="grupo-horas">',g+='<div class="titulo-grupo">Mañana</div>',g+='<div class="contenedor-horas">',b.forEach(e=>{const a=formatearHora12h(e);g+=`<div class="hora-option" data-hora="${e}">${a}</div>`}),g+="</div></div>"),v.length>0&&(g+='<div class="grupo-horas">',g+='<div class="titulo-grupo">Tarde</div>',g+='<div class="contenedor-horas">',v.forEach(e=>{const a=formatearHora12h(e);g+=`<div class="hora-option" data-hora="${e}">${a}</div>`}),g+="</div></div>"),g+="</div>",0===b.length&&0===v.length&&(g='<p class="mensaje-error">No hay horarios disponibles para esta fecha</p>',mostrarAlerta("No hay horarios disponibles para la fecha seleccionada. Intenta con otra fecha o reduce los servicios.","error",".formulario")),e.innerHTML=g,document.querySelectorAll(".hora-option").forEach(e=>{e.addEventListener("click",async function(){document.querySelectorAll(".hora-option.seleccionada").forEach(e=>{e.classList.remove("seleccionada")}),this.classList.add("seleccionada");const e=document.querySelector("#hora");e.value=this.dataset.hora,cita.hora=this.dataset.hora,await validarHoraCita({target:e})})}),cita.hora){const S=document.querySelector(`.hora-option[data-hora="${cita.hora}"]`);S&&S.classList.add("seleccionada")}}catch(y){console.error("Error al cargar horarios:",y),e.innerHTML='<p class="mensaje-error">Error al cargar horarios</p>',mostrarAlerta("Error al cargar los horarios disponibles","error",".formulario")}}else e.innerHTML='<p class="mensaje-info"> Ahora selecciona un Barbero. </p>';else e.innerHTML='<p class="mensaje-info"> Selecciona una Fecha.</p>'}function formatearHora12h(e){const[a,t]=e.split(":").map(Number),o=a>=12?"pm":"am";return`${a%12||12}:${t.toString().padStart(2,"0")} ${o}`}async function verificarDisponibilidadIndividual(e,a,t,o,r=!0){try{const i=await fetch("/citas/verificar-disponibilidad",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fecha:e,hora:a,duracion:t,barberoId:o})});if(!i.ok)throw new Error("Error en la respuesta del servidor");const n=await i.json();return!!n.disponible||(r&&(await Swal.fire({icon:"error",title:"Horario No Disponible",text:n.mensaje,confirmButtonText:"Actualizar",timer:5e3,timerProgressBar:!0}),window.location.reload()),!1)}catch(e){return console.error("Error:",e),!1}}function calcularDuracionTotal(){return cita.servicios&&0!==cita.servicios.length?cita.servicios.reduce((e,a)=>e+(parseInt(a.duracion)||15),0):15}function validarHoraContraActual(e,a){const t=new Date,o=new Date(t.toLocaleString("en-US",{timeZone:"America/Caracas"})),[r,i,n]=e.split("-"),[c,s]=a.split(":"),l=new Date(r,i-1,n,c,s),d=new Date(o.getFullYear(),o.getMonth(),o.getDate()),u=new Date(l.getFullYear(),l.getMonth(),l.getDate());if(u.getTime()===d.getTime()){const e=5,a=new Date(o.getTime()+60*e*1e3);if(l<a){const t=o.toTimeString().substring(0,5);return{valido:!1,mensaje:`No puedes agendar citas para hoy antes de las ${a.toTimeString().substring(0,5)}. La hora actual es ${t}. Se requiere un margen de ${e} minutos.`}}}return u<d?{valido:!1,mensaje:"No puedes agendar citas para fechas pasadas."}:{valido:!0}}async function mostrarResumen(){const e=document.querySelector(".contenido-resumen");if(e){for(;e.firstChild;)e.removeChild(e.firstChild);if(Object.values(cita).includes("")||0===cita.servicios.length)mostrarAlerta("Faltan datos de Servicios, Fecha, u Hora.","error",".contenido-resumen",!1);else try{const a="/api/tasa",t=await fetch(a),o=await t.json();let r;if(Array.isArray(o)&&o.length>0){const e=o[o.length-1];r=parseFloat(e.tasaBs)||1}else r=o.tasaBs&&parseFloat(o.tasaBs)||1;isNaN(r)&&(r=1);const{nombre:i,fecha:n,hora:c,servicios:s,barberoId:l}=cita,d=obtenerDuracionServicio(),[u,m]=c.split(":").map(Number),p=new Date;p.setHours(u,m,0,0),p.setMinutes(p.getMinutes()+d);const h=p.toTimeString().slice(0,5),f=cita.barberoNombre||"No seleccionado",b=document.createElement("H3");b.textContent="Servicios",e.appendChild(b),s.forEach(a=>{const{precio:t,nombre:o,duracion:r}=a,i=document.createElement("DIV");i.classList.add("contenedor-servicio");const n=document.createElement("p");n.textContent=o;const c=document.createElement("P");c.innerHTML=`<span>Precio:</span> $${t}`;const s=document.createElement("P");s.innerHTML=`<span>Duración:</span> ${r} minutos`;const l=document.createElement("P");l.innerHTML=`<span>Barbero:</span> ${f}`,i.appendChild(n),i.appendChild(c),i.appendChild(s),i.appendChild(l),e.appendChild(i)});const v=document.createElement("H3");v.textContent="Resumen de la Cita",e.appendChild(v);const g=document.createElement("P");g.innerHTML=`<span>Nombre:</span> ${i}`;const S=new Date(n),y=S.getMonth(),L=S.getDate()+2,D=S.getFullYear(),E=new Date(Date.UTC(D,y,L)),w={weekday:"long",year:"numeric",month:"long",day:"numeric"},T=E.toLocaleDateString("es-VE",w),C=document.createElement("P");C.innerHTML=`<span>Fecha:</span> ${T}`;const H=document.createElement("P");H.innerHTML=`<span>Horario:</span> ${c} - ${h}`;const q=s.reduce((e,a)=>e+parseFloat(a.precio),0),$=q*r,M=document.createElement("P");M.innerHTML=`<span>Total:</span> $${q.toFixed(2)}`;const A=document.createElement("P");A.innerHTML=`<span>Total Bs:</span> ${$.toFixed()} bs`;const I=document.createElement("BUTTON");I.classList.add("boton"),I.textContent="Reservar Cita",I.onclick=reservarCita,e.appendChild(g),e.appendChild(C),e.appendChild(H),e.appendChild(M),e.appendChild(A),e.appendChild(I)}catch(e){console.error("Error al obtener la tasa:",e),mostrarAlerta("Error al obtener la tasa de cambio","error",".contenido-resumen",!1)}}}async function reservarCita(){if(!cita.barberoId||!cita.fecha||!cita.hora||0===cita.servicios.length)return void mostrarAlerta("Por favor completa todos los campos","error",".contenido-resumen");const{id:e,fecha:a,hora:t,servicios:o,barberoId:r}=cita,i=o.map(e=>e.id),n=obtenerDuracionServicio(),[c,s]=t.split(":").map(Number),l=60*c+s+n,d=l%60;Math.floor(l/60).toString().padStart(2,"0"),d.toString().padStart(2,"0");try{if(!await verificarDisponibilidadIndividual(a,t,n,r,!0))return}catch(e){return console.error("Error al verificar disponibilidad:",e),void mostrarAlerta("Error al verificar disponibilidad","error",".contenido-resumen")}const u=new FormData;u.append("usuarioId",e),u.append("fecha",a),u.append("hora",t),u.append("servicios",i),u.append("barberoId",r);try{const e="/api/citas",a=await fetch(e,{method:"POST",body:u});(await a.json()).resultado&&Swal.fire({icon:"success",title:"Cita Creada",text:"Tu cita ha sido creada exitósamente",button:"OK"}).then(()=>{setTimeout(()=>{window.location.reload()},1e3)})}catch(e){console.error("Error al reservar cita:",e),Swal.fire({icon:"error",title:"Oops...",text:e.message||"Algo salió mal. Por favor, intentalo más tarde"})}}